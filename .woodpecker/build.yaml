when:
  - event: push
    branch: main
steps:
  - name: install_jekyll
    image: ruby:3.1.7
    commands:
      - gem install bundler jekyll
      - bundle install
      - bundle exec jekyll build
  - name: build_image
    image: woodpeckerci/plugin-docker-buildx
    settings:
      repo: codeberg.org/trnzt/home
      registry: codeberg.org
      dockerfile: Dockerfile
      platforms: linux/amd64,linux/arm64/v8
      auto_tag: true
      username:
        from_secret: codeberg_package_username
      password:
        from_secret: codeberg_package_password
